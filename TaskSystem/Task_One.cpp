#pragma once
#include "Task_One.h"

namespace Task_One {
	//生成
	Resorce::WP Resorce::instance;
	//-----------------------------------------------------------------------------------
	//								リソースコンストラクタ！
	//-----------------------------------------------------------------------------------
	Resorce::Resorce() 
	{

	}


	//-----------------------------------------------------------------------------------
	//								リソースデストラクタ！
	//-----------------------------------------------------------------------------------
	Resorce::~Resorce() 
	{


	}


	//-----------------------------------------------------------------------------------
	//							生成時　初期化
	//-----------------------------------------------------------------------------------
	void Object::Init()
	{

		//優先度変更

		//生成時状態変更


		//変数初期化
		_pos = Cursor::Pos();

		_shape = Rect(_pos.x, _pos.y, 50);
	}
	//-----------------------------------------------------------------------------------
	//							更新処理
	//-----------------------------------------------------------------------------------
	void Object::Update()
	{
		this->_shape.x += 4;
		this->_shape.y += 4;
	}

	//-----------------------------------------------------------------------------------
	//							描画処理
	//-----------------------------------------------------------------------------------
	void Object::Draw()
	{
		this->_shape.draw();
	}
	
	//-----------------------------------------------------------------------------------
	//						オブジェクトデストラクタ
	//-----------------------------------------------------------------------------------
	void Object::Finalize()
	{

	}
	//-----------------------------------------------------------------------------------
	//						タスク	デストラクタ
	//-----------------------------------------------------------------------------------
	Object::~Object()
	{

	}




	//-----------------------------------------------------------------------------------
	// ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆
	//								基本的に変更必要なし
	//  ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆ ★☆★☆
	//-----------------------------------------------------------------------------------
	//-----------------------------------------------------------------------------------
	//						リソース　生成と確認
	//-----------------------------------------------------------------------------------
	Resorce::SP Resorce::Create()
	{
		//有無を確認
		auto sp = instance.lock();

		//無ければ生成
		if (!sp) {
			sp = Resorce::SP();
			instance = sp;
		}

		return sp;
	}

	//-----------------------------------------------------------------------------------
	//							オブジェクト生成　&& 初期化
	//-----------------------------------------------------------------------------------
	Object::SP Object::Create() {
		//タスク生成
		Object::SP obj = make_shared<Object>();

		//登録
		ML::Task_System.AddTask(obj);

		//初期化
		obj->Init();

		return obj;
	}

	//-----------------------------------------------------------------------------------
	//					タスク	オブジェクトコンストラクタ
	//-----------------------------------------------------------------------------------
	Object::Object() :
		BTask(defGroupName, defTaskName),
		res(Resorce::Create())
	{

	}

}